<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî A —Å—Ü–µ–Ω–∞—Ä–∏–π</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{
      --bg: #f5f5f7;
      --card: #ffffff;
      --text: #0b0b0b;
      --muted: #eaeaec;
      --accent: #FFBFDE;
      --shadow: 0 6px 18px rgba(0,0,0,.08);
    }
    body[data-theme="dark"]{
      --bg: #0f1115; --card:#171a20; --text:#f2f2f2; --muted:#22262e;
      --shadow: 0 6px 18px rgba(0,0,0,.35);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; line-height:1.35;
    }
    .page{ max-width:460px; margin:0 auto; padding:16px }
    .header{
      position:sticky; top:0; display:flex; justify-content:flex-end; gap:8px;
      padding:8px 0 12px; background:var(--bg); z-index:10;
    }
    .theme-toggle{
      appearance:none; border:1px solid var(--muted); background:var(--card);
      color:var(--text); padding:8px 12px; border-radius:999px; font-size:14px;
      cursor:pointer; box-shadow:var(--shadow);
    }
    .card{ background:var(--card); border-radius:16px; padding:20px; box-shadow:var(--shadow); }
    h1{ margin:0 0 16px; font-size:26px; letter-spacing:-.2px }
    .stack{ display:grid; gap:14px; margin-top:12px }
    .option{
      width:100%; text-align:left; background:var(--muted); color:var(--text);
      border:0; border-radius:16px; padding:16px 18px; font-size:16px; cursor:pointer;
      transition: background .15s ease, transform .04s ease;
    }
    .option:hover,.option:focus-visible{ background:var(--accent); outline:none }
    .option:active{ transform:translateY(1px); background:var(--accent) }
    .option.is-selected{ background:var(--accent) }
    .row{ display:flex; gap:10px; margin-top:14px; flex-wrap:wrap }
    .btn{
      border:0; border-radius:999px; padding:12px 16px; font-size:14px; cursor:pointer;
    }
    .btn-primary{ background:var(--accent); color:#000 }
    .btn-ghost{ background:var(--muted); color:var(--text) }
    .footer-row{ display:flex; justify-content:space-between; align-items:center; margin-top:16px }
    .home, .back{ font-size:14px; border:0; background:transparent; cursor:pointer; color:var(--text); opacity:.8 }
    .hint{ opacity:.65; font-size:13px; margin-top:10px }
    [hidden]{ display:none !important }
    .img-box{ display:flex; justify-content:center; margin:16px 0 8px }
    .img-box img{ max-width:160px; height:auto }
  </style>
</head>
<body>
  <div class="page">
    <div class="header">
      <button class="theme-toggle" id="themeToggle">üåû / üåö</button>
    </div>

    <!-- –≠–∫—Ä–∞–Ω 1 ‚Äî –≥–ª–∞–≤–Ω—ã–π -->
    <section class="card" data-screen="home">
      <h1>–•–æ—á–µ—à—å –∑–∞–±—Ä–∞—Ç—å –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –¥–µ–∫<br/>–∏–ª–∏ —Å–æ–±—Ä–∞—Ç—å —Å–≤–æ–π –∫–∞—Å—Ç–æ–º–Ω—ã–π?</h1>
      <div class="stack">
        <button class="option" onclick="goReady()">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≥–æ—Ç–æ–≤—ã–µ</button>
        <button class="option" onclick="alert('–ü—É—Ç—å B (–∫–∞—Å—Ç–æ–º–Ω—ã–π) –¥–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ ‚ú®')">–°–æ–±—Ä–∞—Ç—å —Å–≤–æ–π</button>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω 3 ‚Äî –≤—ã–±–æ—Ä –∑–∞–¥–∞—á–∏ -->
    <section class="card" data-screen="choose-task" hidden>
      <h1>–î–ª—è –∫–∞–∫–æ–π –∑–∞–¥–∞—á–∏ —Å–æ–±–∏—Ä–∞–µ—à—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é?</h1>
      <div class="stack" id="taskList">
        <button class="option" onclick="pickTask('pitch')">–ü–∏—Ç—á-–¥–µ–∫ –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤</button>
        <button class="option" onclick="pickTask('committee')">–ö–æ–º–∏—Ç–µ—Ç</button>
        <button class="option" onclick="pickTask('mediakit')">–ú–µ–¥–∏–∞–∫–∏—Ç</button>
      </div>
      <div class="footer-row">
        <button class="home" onclick="navigate('home')">üè† –î–æ–º–æ–π</button>
        <span></span>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω 5 ‚Äî –≤—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞ (–∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç task) -->
    <section class="card" data-screen="choose-template" hidden>
      <h1>–í –∫–∞–∫–æ–º —à–∞–±–ª–æ–Ω–µ —Ö–æ—á–µ—à—å –∑–∞–±—Ä–∞—Ç—å –¥–µ–∫?</h1>
      <div class="stack" id="tplList"></div>
      <div class="footer-row">
        <button class="home" onclick="navigate('home')">üè† –î–æ–º–æ–π</button>
        <button class="back" onclick="navigate('choose-task')">‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</button>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω 7 ‚Äî —Ñ–∏–Ω–∞–ª -->
    <section class="card" data-screen="final" hidden>
      <h1 id="finalTitle">–ì–æ—Ç–æ–≤–æ! –ó–∞–±–µ—Ä–∏ –¥–µ–∫</h1>
      <div class="img-box">
        <img src="https://raw.githubusercontent.com/omnibrain-assets/public/main/kirby-cheer.png" alt="kirby cheer" />
      </div>
      <div class="row">
        <button class="btn btn-primary" onclick="download()">–°–∫–∞—á–∞—Ç—å</button>
        <button class="btn btn-ghost" onclick="navigate('choose-template')">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</button>
      </div>
      <div class="footer-row">
        <button class="home" onclick="navigate('home')">üè† –î–æ–º–æ–π</button>
        <span></span>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω 5.2 ‚Äî –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ -->
    <section class="card" data-screen="no-template" hidden>
      <h1>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –¥—Ä—É–≥–∏—Ö —à–∞–±–ª–æ–Ω–∞—Ö —É –Ω–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä :(</h1>
      <p>–ù–æ –º—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å, —Ç–∞–∫ —á—Ç–æ –º–æ–∂–µ—à—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è, –∫–∞–∫–æ–π —à–∞–±–ª–æ–Ω —Ç–µ–±–µ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –≤–∏–¥–µ—Ç—å?</p>
      <div class="row">
        <button class="btn btn-primary" onclick="openSupport()">–û—Å—Ç–∞–≤–∏—Ç—å —Ñ–∏–¥–±–µ–∫</button>
        <button class="btn btn-ghost" onclick="navigate('choose-template')">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</button>
      </div>
      <div class="footer-row">
        <button class="home" onclick="navigate('home')">üè† –î–æ–º–æ–π</button>
        <span></span>
      </div>
    </section>
  </div>

  <script>
    // Telegram WebApp init
    Telegram?.WebApp?.ready?.(); Telegram?.WebApp?.expand?.();

    // –¢–µ–º–∞
    const prefersDark = window.matchMedia?.('(prefers-color-scheme: dark)')?.matches;
    const tgScheme = Telegram?.WebApp?.colorScheme;
    const savedTheme = localStorage.getItem('theme');
    document.body.setAttribute('data-theme', savedTheme || (tgScheme || (prefersDark?'dark':'light')));
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const now = document.body.getAttribute('data-theme')==='dark'?'light':'dark';
      document.body.setAttribute('data-theme', now);
      localStorage.setItem('theme', now);
    });

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
    function navigate(id){
      document.querySelectorAll('[data-screen]').forEach(s=>s.hidden=true);
      document.querySelector(`[data-screen="${id}"]`).hidden=false;
      window.scrollTo({top:0, behavior:'instant'});
    }

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è
    const state = { task:null, template:null };

    // –ú–∞–ø–ø–∏–Ω–≥ –æ–ø—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤ –ø–æ –∑–∞–¥–∞—á–∞–º
    const templateMap = {
      pitch:   ['eda','market','go','none'],
      mediakit:['eda','go','none'],
      committee:['market','eda','none']
    };
    const templateLabels = {
      eda:'–ï–¥–∞', market:'–ú–∞—Ä–∫–µ—Ç', go:'Go', none:'–ù–µ –Ω–∞—à—ë–ª –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ'
    };
    const taskLabels = {
      pitch:'–ü–∏—Ç—á-–¥–µ–∫', mediakit:'–ú–µ–¥–∏–∞–∫–∏—Ç', committee:'–ö–æ–º–∏—Ç–µ—Ç'
    };

    function goReady(){ navigate('choose-task'); }

    function pickTask(task){
      state.task = task; state.template = null;
      renderTemplatesFor(task);
      navigate('choose-template');
    }

    function renderTemplatesFor(task){
      const list = document.getElementById('tplList');
      list.innerHTML = '';
      (templateMap[task]||[]).forEach(code=>{
        const b = document.createElement('button');
        b.className = 'option';
        b.textContent = templateLabels[code];
        b.onclick = ()=>pickTemplate(code);
        list.appendChild(b);
      });
    }

    function pickTemplate(code){
      state.template = code;
      if(code==='none'){ navigate('no-template'); return; }
      // —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
      const tLabel = taskLabels[state.task] || '–¥–µ–∫';
      const tplLabel = templateLabels[code] || '';
      document.getElementById('finalTitle').textContent =
        `–ì–æ—Ç–æ–≤–æ! –ó–∞–±–µ—Ä–∏ ${tLabel.toLowerCase()} –≤ —à–∞–±–ª–æ–Ω–µ ¬´${tplLabel}¬ª`;
      navigate('final');
    }

    // –ó–∞–≥–ª—É—à–∫–∞ ¬´–°–∫–∞—á–∞—Ç—å¬ª
    function download(){
      alert('–§–∞–π–ª –≥–æ—Ç–æ–≤! (–Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–≥–ª—É—à–∫–∞)');
      // –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∏—à—å –Ω–∞—Å—Ç–æ—è—â—É—é –æ—Ç–¥–∞—á—É:
      // Telegram.WebApp.sendData(JSON.stringify({
      //   action:'download', task: state.task, template: state.template
      // }));
      // Telegram.WebApp.close();
      // –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–∏:
      // Telegram.WebApp.openLink('https://example.com/file.zip');
    }

    function openSupport(){
      Telegram?.WebApp?.openTelegramLink?.('https://t.me/viscomms_support'); // –∑–∞–º–µ–Ω–∏ –Ω–∞ –≤–∞—à @
    }
  </script>
</body>
</html>
